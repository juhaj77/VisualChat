(this["webpackJsonpchat-client"]=this["webpackJsonpchat-client"]||[]).push([[0],{243:function(e,t,n){e.exports=n(431)},270:function(e,t,n){},271:function(e,t,n){e.exports=n.p+"static/media/visualchat.c935913a.png"},390:function(e,t,n){},392:function(e,t,n){},395:function(e,t,n){},396:function(e,t,n){},397:function(e,t,n){},398:function(e,t,n){},428:function(e,t){},431:function(e,t,n){"use strict";n.r(t);var a=n(5),r=n.n(a),c=n(0),o=n.n(c),i=n(37),l=n.n(i),s=n(10),u=n(443),d=n(24),f=n(19),m=function(e){var t=Object(c.useState)(""),n=Object(s.a)(t,2),a=n[0],r=n[1];return{input:{type:e,value:a,onChange:function(e){r(e.target.value)}},reset:function(){r("")}}},p=n(28),g=n(29),b=n.n(g),E=function(e){return r.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.a.awrap(b.a.get("".concat("/api/users"),{headers:{Authorization:e.token}}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}))},h=function(e){var t;return r.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return t=null,n.prev=1,n.next=4,r.a.awrap(b.a.post("".concat("/api/users","/signup"),e));case 4:return t=n.sent,n.abrupt("return",t.data);case 8:return n.prev=8,n.t0=n.catch(1),n.abrupt("return",t);case 11:case"end":return n.stop()}}),null,null,[[1,8]])},v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_USERS":return t.data.data.users;case"ADD_USER":return[].concat(Object(p.a)(e),[t.data]);default:return e}},y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_GAPI":return t.data;default:return e}},O=n(21),k=n(20),x=function(e){var t=e.message,n=e.clear,a=Object(c.useState)(t),r=Object(s.a)(a,2),i=r[0],l=r[1],u=Object(c.useState)(!1),d=Object(s.a)(u,2),f=d[0],m=d[1],p=Object(c.useRef)(-1),g=Object(c.useRef)(-1);return Object(c.useEffect)((function(){return t?(m(!0),l(t),p.current=setTimeout((function(){m(!1),g.current=setTimeout((function(){n()}),800)}),5e3)):m(!1),function(){clearTimeout(p.current)}}),[t,n]),Object(k.b)(f,null,{from:{opacity:0},enter:{opacity:1},leave:{opacity:0},config:{duration:250}}).map((function(e){var t=e.item,n=e.key,a=e.props;return t&&o.a.createElement(k.a.div,{key:n,style:Object(O.a)({color:i.color,backgroundColor:"black",border:"1px solid ".concat(i.color),borderRadius:"6px",padding:"1em",fontSize:"1.2em",margin:"0em"},a)},i.content)}))},S=function(e){var t;return r.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,r.a.awrap(b.a.post("".concat("/api/users","/login"),e));case 3:return t=n.sent,n.abrupt("return",t.data);case 7:return n.prev=7,n.t0=n.catch(0),n.abrupt("return",null);case 10:case"end":return n.stop()}}),null,null,[[0,7]])},w=function(e){return window.localStorage.removeItem("loggedChatUser"),{type:"USER_LOGOUT",data:e}},j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USER":return t.data;case"USER_LOGOUT":return null;default:return e}},N=n(25),T=n(444),C=n(449),I=n(230),_=n(450),U=n(104);n(270);function A(){var e=Object(d.a)(["\n    animation-name: backGroundAnim;\n    animation-timing-function:ease-in;\n    animation-duration:500ms;\n    width:100vw;\n    height:100vh;\n  @keyframes backGroundAnim {\n    from {background:black;}\n    to {background:transparent;}\n  }"]);return A=function(){return e},e}function D(){var e=Object(d.a)(["\nborder: 1px solid #665533;\ncursor:pointer;\ncolor:#b29966;\nbackground-color:black;\ntransition: background-color 250ms ease-in, border-color 250ms ease-in, color 250ms ease-in;\n&:hover{\n  background-color:rgba(53, 46, 17, 0.6);\n  border-color: #b29966;\n  color: #d4c6aa;\n}"]);return D=function(){return e},e}var R=n(271),B=N.a.button(D()),z=Object(f.b)((function(e){return{user:e.loggedUser,gapi:e.gapi}}),{setUser:function(e){return function(t){var n;return r.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,r.a.awrap(S(e));case 2:if(n=a.sent){a.next=5;break}throw Error("invalid username or password");case 5:return window.localStorage.setItem("loggedChatUser",JSON.stringify(n)),a.next=8,r.a.awrap(t({type:"SET_USER",data:n}));case 8:case"end":return a.stop()}}))}},clearUser:w,resetUser:function(e){return{type:"SET_USER",data:e}},signUp:function(e){return function(t){var n;return r.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,r.a.awrap(h(e));case 2:if(n=a.sent){a.next=5;break}throw Error("username is in use");case 5:t({type:"ADD_USER",data:n});case 6:case"end":return a.stop()}}))}},setGapi:function(e){return function(t){t({type:"SET_GAPI",data:e})}}})((function(e){var t=m("text"),n=m("password"),a=Object(c.useState)(!1),i=Object(s.a)(a,2),l=i[0],u=i[1],d=Object(c.useState)(null),f=Object(s.a)(d,2),p=f[0],g=f[1],b=Object(c.useState)(!1),E=Object(s.a)(b,2),h=E[0],v=E[1];Object(c.useEffect)((function(){!function(){var t,n;r.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(!(t=window.localStorage.getItem("loggedChatUser"))){a.next=13;break}return a.prev=2,a.next=5,r.a.awrap(JSON.parse(t));case 5:return n=a.sent,a.next=8,r.a.awrap(e.resetUser(n));case 8:a.next=13;break;case 10:a.prev=10,a.t0=a.catch(2),console.log(a.t0.name);case 13:case"end":return a.stop()}}),null,null,[[2,10]])}()}),[]);var y=Object(c.useState)(null),O=Object(s.a)(y,2),S=O[0],w=O[1],j="371216924606-rgdtfalqj9tklp61rkv27d9ii14cenbe.apps.googleusercontent.com";Object(c.useEffect)((function(){!function(){var t;r.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.a.awrap(Object(U.b)());case 2:t=n.sent,e.setGapi(t);case 4:case"end":return n.stop()}}))}()}),[e.gapi]),Object(c.useEffect)((function(){if(e.gapi){!function(){var t;r.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.a.awrap(Object(U.a)(e.gapi,j,""));case 2:(t=n.sent).isSignedIn.get()?D(t.currentUser.get()):B(document.getElementById("customBtn"),t);case 4:case"end":return n.stop()}}))}()}}),[e.gapi]),Object(c.useEffect)((function(){if(e.gapi&&!S){!function(){var t;r.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.a.awrap(Object(U.a)(e.gapi,j,""));case 2:t=n.sent,B(document.getElementById("customBtn"),t);case 4:case"end":return n.stop()}}))}()}}),[S,e.gapi]);var D=function(t){var n=t.getBasicProfile().getName(),a=t.getBasicProfile().getImageUrl(),r=t.getBasicProfile().getEmail(),c=t.getBasicProfile().getId();w({name:n,profileImg:a,email:r,id:c}),e.setUser({idToken:t.xc.id_token})},B=function(e,t){t.attachClickHandler(e,{},(function(e){D(e)}),(function(e){console.log(JSON.stringify(e))}))},z=Object(k.b)((!window.localStorage.getItem("loggedChatUser")||!e.user)&&h,null,{from:{opacity:0},enter:{opacity:1},leave:{opacity:0}}),L=function(e,a){var c;return r.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(e.preventDefault(),o.prev=1,t.input.value&&!(t.input.value.trim().length<3)){o.next=5;break}return g({content:"valid username is required (min length is 3)",color:"red"}),o.abrupt("return");case 5:if(n.input.value&&!(n.input.value.length<3)){o.next=8;break}return g({content:"valid password is required (min length is 3)",color:"red"}),o.abrupt("return");case 8:return c={username:t.input.value.trim(),password:n.input.value},o.next=11,r.a.awrap(a(c));case 11:o.next=17;break;case 13:return o.prev=13,o.t0=o.catch(1),g({content:o.t0.message,color:"red"}),o.abrupt("return");case 17:if(!l){o.next=20;break}return g({content:"account created for user: ".concat(t.input.value,"!"),color:"green"}),o.abrupt("return");case 20:g(null);case 21:case"end":return o.stop()}}),null,null,[[1,13]])},P=function(t){L(t,e.setUser)},W=function(a){return r.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,r.a.awrap(L(a,e.signUp));case 2:u(!1),t.reset(),n.reset();case 5:case"end":return c.stop()}}))},H=function(e,a){return o.a.createElement(T.a,{inverted:!0,style:{paddingTop:"2em",paddingBottom:"1em"},onSubmit:a},o.a.createElement(T.a.Input,Object.assign({icon:"user",iconPosition:"left",label:"Username",placeholder:"Username"},t.input)),o.a.createElement(T.a.Input,Object.assign({icon:"lock",iconPosition:"left",label:"Password",style:{color:"#b29966",backgroundColor:"black",border:"solid 1px #b29966",marginBottom:"0.5em"}},n.input)),o.a.createElement("button",{className:"myButton",autoFocus:!0,type:"submit"},e))},M=N.a.div(A());return h?z.map((function(e){var t=e.item,n=e.key,a=e.props;return t&&o.a.createElement(k.a.div,{key:n,style:a},o.a.createElement("div",{style:{border:"0px",padding:"0px",maxWidth:"1280px",width:"70%",margin:"auto"}},o.a.createElement(I.a,{style:{paddingTop:"7vh"},src:R}),o.a.createElement(_.a,{style:{padding:"0px",margin:"0rem",backgroundColor:"black",border:"solid 1px #665533"},placeholder:!0},!l&&o.a.createElement("div",null,o.a.createElement(C.a,{columns:3,style:{paddingLeft:"3em",paddingRight:"3em",paddingBottom:"2em"},relaxed:"very",stackable:!0},o.a.createElement(C.a.Column,null,H("Login",P)),o.a.createElement(C.a.Column,{verticalAlign:"middle"},o.a.createElement("button",{className:"myButton",onClick:function(){return u(!0)},type:"button"},"Sign up")),o.a.createElement(C.a.Column,{verticalAlign:"middle"},o.a.createElement("button",{id:"customBtn",className:"myButton",style:{whiteSpace:"nowrap"}},"Google Login")))),l&&H("Sign Up",W)),o.a.createElement(x,{message:p,clear:function(){return g(null)}})))})):o.a.createElement(M,null,o.a.createElement(I.a,{onLoad:function(){return v(!0)},style:{display:"none",paddingTop:"7vh"},src:R}),o.a.createElement("span",{style:{position:"absolute",top:"50%",left:"50%",fontSize:"2em",color:"#b29966",marginLeft:"-5rem"}},"loading..."))})),L=n(224),P=function(e,t){var n;return r.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,r.a.awrap(b.a.get("".concat("/api/channels","/").concat(e),{headers:{Authorization:t.token}}));case 2:return n=a.sent,a.abrupt("return",n.data);case 4:case"end":return a.stop()}}))},W=function(){return{type:"REMOVE_ANIMATION"}},H=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_MESSAGES":return t.data;case"SOCKET_MESSAGE_RECEIVED":var n=t.data.messages.slice();return n[n.length-1]="UUSIVIESTI:".concat(n[n.length-1]),n;case"SEND_WEBSOCKET_MESSAGE":return[].concat(Object(p.a)(e),[t.data.message]);case"REMOVE_ANIMATION":return e.map((function(e){return"UUSIVIESTI"==e.split(":",1)?e.replace("UUSIVIESTI:",""):e}));case"NEW_FEED":return[];default:return e}},M=(n(390),Object(f.b)(null,{removeAnimation:W})((function(e){var t=e.message.split(":",1),n=e.message.replace(t+":",""),a=!1;"UUSIVIESTI"==t&&(t=n.split(":",1),n=n.replace(t+":",""),a=!0);var r,c=n.split(";",1),i=void 0;"Invalid Date"!=function(e){try{var t=e.slice(0,4),n=e.slice(5,7),a=e.slice(8,10),r=e.slice(11,13),c=e.slice(14,16),o=e.slice(17,19);return new Date(t,n,a,r,c,o,0)}catch(i){return}}(c[0])&&(r=c[0],i=r.slice(8,10)+"."+r.slice(5,7)+". "+r.slice(11,16),n=n.replace(c[0]+";",""));var l={color:"#e5ddcc",marginRight:"0.7rem",marginLeft:"0.3rem",marginBottom:"0.5rem",backgroundColor:"transparent",display:"inline-block",float:"left"},s={marginRight:"0.7rem",marginLeft:"0.3rem",float:"left",lineHeight:"1em"};e.user==t&&(l.textAlign="right",l.float="right",s.textAlign="right",s.float="right");return o.a.createElement("div",{style:{marginBottom:"0px"}},o.a.createElement("div",{style:{clear:"left"}}),o.a.createElement("div",{style:s},i?o.a.createElement(o.a.Fragment,null,o.a.createElement("span",{style:{color:"white",marginBottom:"0px"}},t),o.a.createElement("span",{style:{color:"#d4c6aa",fontSize:"10px",marginBottom:"0px"}},"\xa0\xa0",i),o.a.createElement("br",null)):o.a.createElement(o.a.Fragment,null,o.a.createElement("span",{style:{color:"white",fontWeight:"500",marginBottom:"0px"}},t),o.a.createElement("br",null))),o.a.createElement("div",{style:{clear:"right"}}),o.a.createElement("div",{style:{clear:"left"}}),o.a.createElement("div",{style:l},a?o.a.createElement("div",{className:"mymessage",onAnimationEnd:e.removeAnimation},n):o.a.createElement("div",{style:{color:"#e9d396",padding:"8px 12px 8px 12px",borderRadius:"9px",backgroundColor:"rgba(5, 5, 5,0.5)"}},n)),o.a.createElement("div",{style:{clear:"right"}}))})));function G(){var e=Object(d.a)(["\n      padding: 0.1em 0.3em;\n      height: 33em;\n      background-image:linear-gradient(rgba(85, 71, 43,0.7),rgba(22,12,12,0.7));\n      color:#d9d9d9;\n  "]);return G=function(){return e},e}var F=Object(f.b)((function(e){return{user:e.loggedUser,messages:e.messages}}),null)((function(e){var t=N.a.div(G());return e.user?o.a.createElement(t,null,o.a.createElement(L.a,null,e.messages.map((function(t,n){return o.a.createElement(M,{index:e.messages.length-n,key:n,message:t,user:e.user.username})})))):o.a.createElement("div",null)})),K=Object(f.b)((function(e){return{user:e.loggedUser,channel:e.channel}}),{addMsg:function(e,t,n){return function(a){var r=new Date;a({type:"SEND_WEBSOCKET_MESSAGE",data:{message:"".concat(t.username,":").concat(new Date(r.getTime()-60*r.getTimezoneOffset()*1e3).toISOString(),";").concat(e),channel:n,token:t.token}})}},removeAnimation:W})((function(e){var t=Object(c.useState)(null),n=Object(s.a)(t,2),a=n[0],i=n[1],l=m("text");Object(c.useEffect)((function(){i(null)}),[e.channel]),Object(c.useEffect)((function(){return function(){return i(null)}}),[]);var u=function(){var t;return r.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(t=l.input.value,""==e.channel){n.next=9;break}return i(null),n.next=5,r.a.awrap(e.removeAnimation());case 5:return n.next=7,r.a.awrap(e.addMsg(t,e.user,e.channel.id));case 7:n.next=10;break;case 9:i({content:"select channel first",color:"red"});case 10:l.reset();case 11:case"end":return n.stop()}}))};return e.user?o.a.createElement("div",{style:{background:"black",border:"none"}},o.a.createElement("input",Object.assign({placeholder:"write your msg here",style:{padding:"0.1em 0 0.1em 0",fontWeight:"500",fontSize:"1.2em",paddingLeft:"0.4em",lineHeight:"1.2em",backgroundColor:"black",borderTop:"none",borderBottom:"1px solid #443922",borderLeft:"none",borderRight:"none",color:"#b29966",width:"80%"},onKeyPress:function(e){"Enter"===e.key&&u()}},l.input)),o.a.createElement(Me,{style:{padding:"0.2em 0 0.15em 0",marginTop:"0px",fontFamily:"Lato,Helvetica Neue,Arial,Helvetica,sans-serif",fontWeight:"700",width:"20%"},onClick:u},"send"),o.a.createElement(x,{message:a,clear:function(){return i(null)}})):o.a.createElement("div",null)})),Y=function(e){return r.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.a.awrap(b.a.get("".concat("/api/channels","/user/").concat(e.userId),{headers:{Authorization:e.token}}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}))},V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_CHANNELS":return t.data.data.channels;case"SOCKET_ADD_CHANNEL":return e.concat(t.data);default:return e}},X=function(e,t){var n;return r.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,r.a.awrap(b.a.get("".concat("/api/channels","/").concat(e,"/notes"),{headers:{Authorization:t.token}}));case 2:return n=a.sent,a.abrupt("return",n.data);case 4:case"end":return a.stop()}}))},q=function(e,t,n){return{type:"SET_NOTE",data:{note:e,channel:t,token:n.token}}},J=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_NOTES":return t.data;case"SET_NOTE":var n=t.data.note;return e.map((function(e){return n.id===e.id?n:e}));case"SOCKET_ADD_NOTE":return e.concat(t.data);case"SOCKET_SET_NOTE":return e.map((function(e){return t.data.id===e.id?t.data:e}));case"SOCKET_DELETE_NOTE":return e.filter((function(e){return e.id!==t.data}));case"INIT_EMPTY":return[];default:return e}},$=function(e,t){var n;return r.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,r.a.awrap(b.a.get("".concat("/api/channels","/").concat(e,"/pictures"),{headers:{Authorization:t.token}}));case 2:return n=a.sent,a.abrupt("return",n.data);case 4:case"end":return a.stop()}}))},Q=function(e,t,n){return{type:"ADD_PICTURE",data:{picture:e,id:t,token:n.token}}},Z=function(e,t){return{type:"CALLBACK",data:{id:e,token:t.token}}},ee=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_PICTURES":return t.data;case"ADD_PICTURE":return e.concat(t.data.picture.data);case"CALLBACK":default:return e}},te=function(e,t,n){return function(a){a({type:"SET_CHANNEL",data:{id:e,name:t,user:n.username,token:n.token}})}},ne=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CHANNEL":return t.data;default:return e}},ae=Object(f.b)((function(e){return{channels:e.channels,channel:e.channel,user:e.loggedUser,pictures:e.pictures}}),{initializeChannels:function(e){return function(t){var n;return r.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,r.a.awrap(Y(e));case 2:return n=a.sent,a.next=5,r.a.awrap(t({type:"GET_CHANNELS",data:n}));case 5:case"end":return a.stop()}}))}},setChannel:te,initializeMessages:function(e,t){return function(n){var a;return r.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,r.a.awrap(P(e,t));case 2:return a=c.sent,c.next=5,r.a.awrap(n({type:"INIT_MESSAGES",data:a}));case 5:case"end":return c.stop()}}))}},initializePictures:function(e,t){return function(n){var a;return r.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,r.a.awrap($(e,t));case 2:a=c.sent,n({type:"INIT_PICTURES",data:a});case 4:case"end":return c.stop()}}))}},initializeNotes:function(e,t){return function(n){var a;return r.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,r.a.awrap(X(e,t));case 2:a=c.sent,n({type:"INIT_NOTES",data:a});case 4:case"end":return c.stop()}}))}}})((function(e){Object(c.useEffect)((function(){e.initializeChannels(e.user)}),[]);return o.a.createElement("div",null,o.a.createElement("select",{onChange:function(t){var n,a,c;return r.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(t.preventDefault(),n=t.target.selectedIndex,a=t.target.childNodes[n].value,0===n||a===e.channel.name){o.next=13;break}return c=e.channels.find((function(e){return e.name==a})).id,o.next=7,r.a.awrap(e.setChannel(c,a,e.user));case 7:return o.next=9,r.a.awrap(e.initializeMessages(c,e.user));case 9:return o.next=11,r.a.awrap(e.initializeNotes(c,e.user));case 11:return o.next=13,r.a.awrap(e.initializePictures(c,e.user));case 13:case"end":return o.stop()}}))},style:{border:"none",cursor:"pointer",paddingLeft:"0.4em",fontSize:"1.4em",fontFamily:"Abhaya Libre, serif",fontWeight:"900",color:"#b29966",borderColor:"black",backgroundColor:"black",width:"100%"}},[o.a.createElement("option",{key:"-1",defaultValue:""},"select channel:")].concat(Object(p.a)(e.channels.map((function(e,t){return o.a.createElement("option",{value:e.name,key:t},e.name)}))))))})),re=Object(f.b)((function(e){return{user:e.loggedUser}}))((function(e){return o.a.createElement("div",null,o.a.createElement("div",{style:{backgroundColor:"black",color:"white",borderBottom:"1px solid #443922",marginTop:"-0.2em"}},o.a.createElement("table",{style:{width:"100%",borderTop:"1px solid #443922"}},o.a.createElement("tbody",null,o.a.createElement("tr",null,o.a.createElement("td",{style:{paddingLeft:"0.6em",fontSize:"1.2em",fontWeight:"bold",paddingBottom:"0em",width:"50%"}},o.a.createElement("div",{style:{fontFamily:"Abhaya Libre, serif",fontWeight:"800",baddingBottom:"0px",marginBottom:"-0.2em",color:"#e9d396"}},"CHANNEL")),o.a.createElement("td",{style:{whiteSpace:"nowrap",width:"50%",marginRight:"0%",paddingRight:"0px",borderRight:"0px",textAlign:"right"}},o.a.createElement("div",{style:{color:"#d4c6aa",fontSize:"1.3em",fontFamily:"Abhaya Libre, serif",fontWeight:"700",baddingBottom:"0px",whiteSpace:"nowrap",display:"inline"}},"create new channel"),o.a.createElement("div",{style:{marginLeft:"0.5em",display:"inline"}},o.a.createElement(Me,{style:{fontFamily:"Lato,Helvetica Neue,Arial,Helvetica,sans-serif",fontWeight:"700"},onClick:function(){e.setChat(!1)}},"create"))))))),o.a.createElement(ae,{user:e.user}),o.a.createElement(F,null),o.a.createElement(K,null))})),ce=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_ERROR":return t.data;default:return e}},oe=n(446);function ie(){var e=Object(d.a)(["\n    font-size:1.1em;\n    font-weight:500; \n    padding:0.25em 0.4em 0.4em 0.4em;\n    border-radius:2px;\n    vertical-align:middle;\n    margin-top:1.4em;\n    display:inline;\n  "]);return ie=function(){return e},e}var le=Object(f.b)((function(e){return{user:e.loggedUser,users:e.users,channels:e.channels,error:e.error}}),{initializeUsers:function(e){return function(t){var n;return r.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,r.a.awrap(E(e));case 2:n=a.sent,t({type:"GET_USERS",data:n});case 4:case"end":return a.stop()}}))}},createChannel:function(e,t,n){return function(a){a({type:"CREATE_CHANNEL",data:{name:e,users:t,token:n.token}})}},setError:function(e){return function(t){t({type:"SET_ERROR",data:e})}},setChannel:te,newFeed:function(){return{type:"NEW_FEED"}},initEmpty:function(){return{type:"INIT_EMPTY"}}})((function(e){var t=Object(c.useState)([]),n=Object(s.a)(t,2),a=n[0],i=n[1],l=m("text"),u=Object(c.useState)(null),d=Object(s.a)(u,2),f=d[0],g=d[1],b=Object(c.useState)(e.channels.length),E=Object(s.a)(b,2),h=E[0],v=E[1],y=function(){g(null),e.setError(null)};Object(c.useEffect)((function(){e.error&&g({content:e.error.message,color:"red"})}),[e.error]),Object(c.useEffect)((function(){if(e.user&&e.initializeUsers(e.user),h<e.channels.length){v(e.channels.length);!function(){var t;r.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.a.awrap(e.channels.find((function(e){return e.name===l.input.value.trim()})).id);case 2:return t=n.sent,n.next=5,r.a.awrap(e.setChannel(t,l.input.value.trim(),e.user));case 5:return n.next=7,r.a.awrap(e.newFeed());case 7:return n.next=9,r.a.awrap(e.initEmpty());case 9:y();case 10:case"end":return n.stop()}}))}(),e.setChat(!0)}return function(){y()}}),[e.channels]);var O=Object(N.a)(Me)(ie());return e.users?o.a.createElement("div",{style:{textAlign:"center"}},o.a.createElement(T.a,{inverted:!0},o.a.createElement(T.a.Input,Object.assign({label:"Name",placeholder:"channel name",style:{width:"80%",margin:"auto"}},l.input)),o.a.createElement("div",{style:{width:"80%",margin:"auto"}},o.a.createElement("div",{style:{color:"white",fontWeight:"bold",paddingBottom:"0.3em"}},"Users"),o.a.createElement(oe.a,{label:"Users",placeholder:"users",fluid:!0,multiple:!0,search:!0,selection:!0,options:e.users.filter((function(t){return t.id!==e.user.userId})).map((function(e){return{key:e.id,text:e.username,value:e.id}})),onChange:function(e,t){e.preventDefault(),i(t.value)}})),o.a.createElement("div",{style:{margin:"auto",textAlign:"center"}},o.a.createElement(O,{type:"button",onClick:function(t){var n;return r.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:if(t.preventDefault(),n=l.input.value.trim(),!(a.length>0&&""!==n)){c.next=10;break}if(!e.channels.find((function(e){return e.name===n}))){c.next=6;break}return g({content:"dublicate channel name",color:"red"}),c.abrupt("return");case 6:return c.next=8,r.a.awrap(e.createChannel(n,[].concat(Object(p.a)(a),[e.user.userId]),e.user));case 8:c.next=11;break;case 10:g({content:"users or name missing",color:"red"});case 11:case"end":return c.stop()}}))}},"create"),o.a.createElement(O,{type:"button",style:{marginLeft:"1.4em"},onClick:function(){e.setChat(!0)}},"cancel"))),o.a.createElement("div",{style:{margin:"auto",width:"80%",marginTop:"2em"}},o.a.createElement(x,{message:f,clear:y}))):o.a.createElement("div",null)})),se=n(448),ue=n(447),de=(n(190),n(99)),fe=new Map([["#ffffcc",{background:"linear-gradient(20deg,#756b57,#a89e8a)",color:"black",fontWeight:"700"}],["#ffcccc",{background:"linear-gradient(20deg,#77633c,#b29966)",color:"black",fontWeight:"700"}],["#ccffff",{background:"linear-gradient(20deg,#221a11,#664d33)",color:"#e9d396",fontWeight:"700"}],["#99ffcc",{background:"linear-gradient(20deg,#6b5147,#a38175)",color:"black",fontWeight:"700"}],["#ffccff",{background:"linear-gradient(20deg,#634136,#a66c59)",color:"black",fontWeight:"700"}],["#80ffff",{background:"linear-gradient(20deg,#240f0f,#6b2e2e)",color:"#e9d396",fontWeight:"700"}],["#ff99c2",{background:"linear-gradient(20deg,#798086,#afb3b6)",color:"black",fontWeight:"700"}],["#99ff99",{background:"linear-gradient(20deg,#3d4043,#6d7378)",color:"black",fontWeight:"700"}],["#ff99ff",{background:"linear-gradient(20deg,#272428,#5c555e)",color:"#e9d396",fontWeight:"700"}]]),me=(n(392),Object(f.b)((function(e){return{user:e.loggedUser,channel:e.channel,notes:e.notes}}),{setNote:q})((function(e){var t=Object(c.useState)(e.content),n=Object(s.a)(t,2),a=n[0],i=n[1],l=Object(c.useState)(e),u=Object(s.a)(l,2),d=u[0],f=u[1],m=Object(c.useState)(!0),p=Object(s.a)(m,2),g=p[0],b=p[1];Object(c.useEffect)((function(){i(e.content)}),[e.content]),Object(c.useEffect)((function(){f(e)}),[e]),Object(c.useEffect)((function(){return function(){b(!1)}}),[e.channel]);var E=function(e){i(e.target.value)},h=Object(k.b)(g,null,{from:{opacity:0,transform:"scale(0)"},enter:{opacity:1,transform:"scale(1)"},leave:{opacity:0,transform:"scale(0)"}}),v=Object(ue.a)({item:{id:e.id,left:e.left,top:e.top,type:"note"},collect:function(e){return{isDragging:e.isDragging()}}}),y=Object(s.a)(v,2),x=y[0].isDragging,S=y[1];if(x)return o.a.createElement("div",{ref:S});var w=function(t){var n,c;return r.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(n=e.notes.find((function(e){return e.id===t})),c=new Date,n.content===a){o.next=5;break}return o.next=5,r.a.awrap(e.setNote(Object(O.a)({},n,{content:a,author:e.user.username,date:new Date(c.getTime()-60*c.getTimezoneOffset()*1e3).toISOString()}),e.channel.id,e.user));case 5:case"end":return o.stop()}}))};return h.map((function(e){var t=e.item,n=e.key,r=e.props;return t&&o.a.createElement(k.a.div,{key:n,className:"note",ref:S,id:d.id,style:Object(O.a)({left:d.left,top:d.top},fe.get(d.backgroundColor),{},r)},o.a.createElement(de.Tooltip,{title:"open Edit Note - menu with the right mouse button",followCursor:"true",theme:"transparent",duration:"800",delay:"300",trigger:"mouseenter"},o.a.createElement("div",{className:"noteHeader",style:{marginTop:"0px",marginBottom:"0px"}},d.author," ",function(e){if(e)return e.slice(8,10)+"."+e.slice(5,7)+". "+e.slice(11,16)}(d.date))),o.a.createElement("textarea",{className:"txt-mesta",style:Object(O.a)({textAlign:"center",border:"0px solid transparent",paddingLeft:"0.2em",fontSize:"1.2em",lineHeight:"1.1rem",width:"100%",height:"70%"},fe.get(d.backgroundColor)),value:a,onChange:E,onBlur:function(){return w(d.id)}}))}))})));function pe(){var e=Object(d.a)(["\n  font-size: 1.5em;\n  padding: 0 .2em 0 0em;\n  font-family: Russo One; sans-serif;\n  color: #a9bfd6;\n"]);return pe=function(){return e},e}function ge(){var e=Object(d.a)(["\n  display: inline-block;\n  float: left;\n  text-align: left;\n  line-height: 1.5em;\n  border-bottom: .1em solid black;\n  border-radius: 0 0 .333em 0;\n  background-color: black;\n"]);return ge=function(){return e},e}function be(){var e=Object(d.a)(["\n  position: relative;\n  top: 1.5em;\n  height: fit-content;\n  lineHeight: 1.5em;\n"]);return be=function(){return e},e}var Ee=N.a.div(be()),he=N.a.div(ge()),ve=N.a.div(pe()),ye=function(e){var t=e.title;return o.a.createElement(Ee,null,o.a.createElement(he,null,o.a.createElement(ve,null,t)))},Oe=Object(f.b)((function(e){return{channel:e.channel}}),null)((function(e){var t=Object(c.useState)(!1),n=Object(s.a)(t,2),a=n[0],r=n[1],i=Object(k.b)(a,null,{from:{opacity:0},enter:{opacity:1},leave:{opacity:0}}),l=Number(e.top)+60,u=Number(e.left)+60,d=e.name;Object(c.useEffect)((function(){return function(){r(!1)}}),[e.channel]);var f=new Image;return f.src="data:".concat(e.picture.contentType,";")+"base64,".concat(function(e){var t="";return[].slice.call(new Uint8Array(e)).forEach((function(e){return t+=String.fromCharCode(e)})),window.btoa(t)}(e.picture.data.data)),f.onload=function(){return r(!0)},i.map((function(e){var t=e.item,n=e.key,a=e.props;return t&&o.a.createElement(k.a.div,{key:n,style:Object(O.a)({},a,{position:"absolute",top:l,left:u})},o.a.createElement("div",{className:"image",style:{width:"fit-content",zIndex:"0",textAlign:"center",height:"calc(100vh/2 - 1em/3)",margin:"0 1em 0 0"}},o.a.createElement(ye,{title:d}),o.a.createElement("img",{src:f.src,alt:d})))}))})),ke=n(39),xe=(n(394),n(451));function Se(){var e=Object(d.a)(["\n  line-height: 1em;\n  height: 2.6em;  \n  font-size: 1em; \n  width:97%;\n  margin: 0; \n  padding: 0;\n"]);return Se=function(){return e},e}function we(){var e=Object(d.a)(["\n  line-height: 1em; \n  margin: 0.2em 0 0.3em 0; \n  font-size: 1.2em;\n  font-weight:bold; \n"]);return we=function(){return e},e}function je(){var e=Object(d.a)(["\n  text-align: center;\n  font-size: 2em; \n  line-height: 1em; \n  font-weight: 800; \n  padding: 0; \n"]);return je=function(){return e},e}function Ne(){var e=Object(d.a)(["\n  overflow:visible; \n  color: #665533; \n  background: black;\n  border:solid 1px #665533;\n  display: flex; \n  flex-direction: column; \n  justify-content: space-between; \n  align-items: flex-start; \n  margin:1.666em 0 0 0;\n  align-content: space-between; \n  padding: .5em; \n  white-space: nowrap;\n"]);return Ne=function(){return e},e}function Te(){var e=Object(d.a)(["\n  text-align: center; \n  width: 100%; \n  align-self: strech;\n"]);return Te=function(){return e},e}var Ce={autoClose:!1,position:ke.b.POSITION.BOTTOM_CENTER,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:.5},Ie=N.a.div(Te()),_e=N.a.div(Ne()),Ue=N.a.span(je()),Ae=N.a.p(we()),De=N.a.input(Se()),Re=Object(f.b)((function(e){return{channel:e.channel,user:e.loggedUser}}),null)((function(e){var t=e.setVisible,n=e.top,a=e.left,i=e.channelId,l=e.user,u=e.channel,d=Object(c.useState)(0),p=Object(s.a)(d,2),g=p[0],E=p[1],h=Object(c.useState)(null),v=Object(s.a)(h,2),y=v[0],O=v[1],k=m("text"),x=Object(f.c)();console.log("\nUploadForm data:",a,n);return o.a.createElement(_e,{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",zIndex:"199",position:"absolute",top:n,left:a}},o.a.createElement(Ue,null,"select picture"),o.a.createElement(Ie,null,o.a.createElement(Ae,null,"small png. max 1M "),o.a.createElement("input",{style:{paddingLeft:"0.5em",lineHeight:"1.5em",fontSize:"1em",margin:"0",background:"black",color:"#665533"},type:"file",name:"upload_file",className:"form-control-file",onChange:function(e){var t=e.target.files;t[0]&&t[0].size<1e6&&t[0].name.match(/\.(png)$/)?(E(0),O(t[0])):ke.b.warn("File type is wrong or file size too big!",{position:ke.b.POSITION.BOTTOM_CENTER})}})),o.a.createElement(Ie,null,o.a.createElement(Ae,null,"name: "),o.a.createElement(De,Object.assign({placeholder:"required"},k.input,{className:"form-control",required:!0}))),o.a.createElement(Ie,null,o.a.createElement(ke.a,{style:{zIndex:"5000",fontSize:"1.4em"}}),o.a.createElement(xe.a,{max:"100",color:"success",value:g},Math.round(g,2),"%"),o.a.createElement(B,{type:"submit",onClick:function(e){var c,o=new FormData;y?(o.append("uploaded_file",y),""!=k.input.value?(o.append("name",k.input.value),o.append("top",n),o.append("left",a),c=o,r.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return ke.b.info("uploading...",Ce),e.next=3,r.a.awrap(b.a.post("".concat("/api/pictures","/add/").concat(i),c,{onUploadProgress:function(e){E(e.loaded/e.total*100)}}).then((function(e){x(Q(e,u.id,l)),x(Z(u.id,l))})).catch((function(e){console.log(e)})));case 3:t({visible:!1});case 4:case"end":return e.stop()}}))):ke.b.error("name is required",{position:ke.b.POSITION.BOTTOM_CENTER})):ke.b.error("select file",{position:ke.b.POSITION.BOTTOM_CENTER})}},"submit"),"\u2002\u2002\u2002\u2002",o.a.createElement(B,{type:"submit",onClick:function(){return t(!1)}},"cancel")))})),Be=(n(395),Object(f.b)((function(e){return{user:e.loggedUser,channel:e.channel,notes:e.notes,pictures:e.pictures}}),{addNote:function(e,t,n){return{type:"ADD_NOTE",data:{note:e,channel:t,token:n.token}}},setNote:q,deleteNote:function(e,t,n){return{type:"DELETE_NOTE",data:{noteID:e,channelID:t,token:n.token}}}})((function(e){var t,n,a=Object(c.useState)({visible:!1}),r=Object(s.a)(a,2),i=r[0],l=r[1],u=Object(c.useState)({visible:!1}),d=Object(s.a)(u,2),f=d[0],m=d[1],p=Object(c.useState)({visible:!1}),g=Object(s.a)(p,2),b=g[0],E=g[1],h=Object(c.useState)({left:"0px",top:"0px"}),v=Object(s.a)(h,2),y=v[0],x=v[1],S=Object(c.useState)(void 0),w=Object(s.a)(S,2),j=w[0],N=w[1],T=Object(c.useRef)(!1),C=Object(c.useState)("5"),I=Object(s.a)(C,2),_=I[0],U=I[1],A=Object(k.b)(i.visible||f.visible,null,{from:{opacity:0,rotation:-1},enter:{opacity:1,rotation:0},leave:{opacity:0,rotation:1}}),D=Object(k.b)(b.visible,null,{from:{opacity:0,rotation:-1},enter:{opacity:1,rotation:0},leave:{opacity:0,rotation:1}}),R=Object(se.a)({accept:["note"],drop:function(e,t){var n=t.getDifferenceFromInitialOffset(),a=Math.round(e.left+n.x),r=Math.round(e.top+n.y);"note"==e.type&&z(e.id,a,r)}}),B=Object(s.a)(R,2)[1],z=function(t,n,a){var r=e.notes.find((function(e){return e.id===t}));e.setNote(Object(O.a)({},r,{top:a,left:n}),e.channel.id,e.user)},L=function(e){var t=Number(e.target.offsetParent.style.left.replace("px",""))+Number(e.nativeEvent.offsetX),n=Number(e.target.offsetParent.style.top.replace("px",""))-Number(e.nativeEvent.offsetY);m({visible:!0,id:e.nativeEvent.target.offsetParent.id,style:{position:"absolute",left:t,top:n,zIndex:1e3}}),l({visible:!1})},P=function(t){t.preventDefault();var n=new Date,a=i.style.top+document.getElementById("wa").offsetHeight;e.addNote({left:i.style.left,top:a,backgroundColor:"#ffffcc",date:new Date(n.getTime()-60*n.getTimezoneOffset()*1e3),author:e.user.username},e.channel.id,e.user),N(!1),l({visible:!1})},W=function(e){e.preventDefault();var t=i.style.top+document.getElementById("wa").offsetHeight,n={visible:!0,style:{zIndex:1e3,position:"absolute",left:i.style.left,top:t}};E(n),l({visible:!1}),m({visible:!1})},H=function(t){t.preventDefault(),e.deleteNote(f.id,e.channel.id,e.user)},M=function(t){t.preventDefault();var n=e.notes.find((function(e){return e.id===f.id}));e.setNote(Object(O.a)({},n,{backgroundColor:t.nativeEvent.target.id}),e.channel.id,e.user),G()},G=function(){l({visible:!1}),m({visible:!1}),N(!1)},F=!1,K=Object(c.useRef)(-1),Y=Object(c.useRef)(!0),V=Object(c.useCallback)((function(){Y.current||clearTimeout(K.current),Y.current&&-1===K.current&&(K.current=setTimeout((function(){T.current=!0}),12e3))}),[]);Object(c.useEffect)((function(){return function(){Y.current=!1,V()}}),[V]);return e.notes?o.a.createElement("div",{id:"dndWrapper",onContextMenu:function(e){e.preventDefault();var t=e.nativeEvent.offsetY-document.getElementById("wa").offsetHeight,n=e.nativeEvent.offsetX;if(console.log("event.nativeEvent.offset X Y",n,t,'\ndocument.getElementById("wa").offsetHeight',document.getElementById("wa").offsetHeight,"\noffsetParent",e.target.offsetParent.style.left,e.target.offsetParent.style.top,"\nevent.nativeEvent.target.id",e.nativeEvent.target.id),i.visible||f.visible)return m({visible:!1}),void l({visible:!1});"dnd2"===e.target.id?(l({visible:!0,style:{zIndex:1e3,position:"absolute",left:n,top:t}}),m({visible:!1})):"txt-mesta"!==e.nativeEvent.target.className&&"wa"!==e.nativeEvent.target.id&&L(e)},onPointerOver:function(e){T.current||"dnd"!==e.target.id||j?N(!1):N(!0)},onPointerDown:function(e){N(!1),"dnd"===e.target.id&&U("2")},onPointerOut:function(){return N(!1)},onClick:G,onMouseMove:function(e){"txt-mesta"!==e.target.className&&"note"!==e.target.className&&"noteHeader"!==e.target.className||N(!1),F&&"note"!==e.target.className&&(document.getElementById("dndWrapper").style.left="".concat(e.pageX-t,"px"),document.getElementById("dndWrapper").style.top="".concat(e.pageY-n,"px"),document.getElementById("root").style.backgroundPositionX=.5*(e.pageX-t)+"px",document.getElementById("root").style.backgroundPositionY=.5*(e.pageY-n)+"px",document.getElementById("bg").style.backgroundPositionX=.25*(e.pageX-t)+"px",document.getElementById("bg").style.backgroundPositionY=.25*(e.pageY-n)+"px")},onMouseDown:function(e){"dndC"===e.target.className&&(F=!0,t=e.clientX-Number(y.left.replace("px","")),n=e.clientY-Number(y.top.replace("px","")))},onMouseUp:function(e){F=!1,"dndC"===e.target.className&&(x({left:document.getElementById("dndWrapper").style.left,top:document.getElementById("dndWrapper").style.top}),U("5"))},style:Object(O.a)({},y)},o.a.createElement("div",{className:"hoverjuttu"},o.a.createElement("div",{id:"dnd2",className:"dndC",style:{zIndex:"3"}}),o.a.createElement(de.Tooltip,{open:j,title:"add note with the right mouse button",followCursor:"true",theme:"transparent",duration:"800",onShown:V},o.a.createElement("div",{ref:B,id:"dnd",className:"dndC",style:{zIndex:_}},o.a.createElement("div",{id:"wa"},"\xa0draggable working area"),i.visible&&A.map((function(e){var t=e.item,n=e.key,a=e.props;return t&&o.a.createElement(k.a.div,{className:"menu",key:n,style:Object(O.a)({},i.style,{width:"9rem"},a)},o.a.createElement("ul",{className:"menu-options"},o.a.createElement("li",{className:"menu-option",onClick:P},"add note"),o.a.createElement("li",{className:"menu-option",onClick:W},"upload picture")))})),f.visible&&A.map((function(e){var t=e.item,n=e.key,a=e.props;return t&&o.a.createElement(k.a.div,{className:"menu",key:n,style:Object(O.a)({},f.style,{width:"9rem"},a)},o.a.createElement("ul",{className:"menu-options"},o.a.createElement("li",{className:"menu-option",onClick:H},"delete note"),o.a.createElement("li",{className:"menu-option"},o.a.createElement("div",{className:"dropdown"},"set color",o.a.createElement("div",{className:"dropdown-content"},o.a.createElement("table",{style:{width:"6em",height:"6em",background:"black",border:"solid 1px #665533",cursor:"auto"}},o.a.createElement("tbody",null,o.a.createElement("tr",null,o.a.createElement("td",null,o.a.createElement("button",{className:"button",id:"#ffffcc",onClick:M,style:{background:fe.get("#ffffcc").background}})),o.a.createElement("td",null,o.a.createElement("button",{className:"button",id:"#ffcccc",onClick:M,style:{background:fe.get("#ffcccc").background}})),o.a.createElement("td",null,o.a.createElement("button",{className:"button",id:"#ccffff",onClick:M,style:{background:fe.get("#ccffff").background}}))),o.a.createElement("tr",null,o.a.createElement("td",null,o.a.createElement("button",{className:"button",id:"#99ffcc",onClick:M,style:{background:fe.get("#99ffcc").background}})),o.a.createElement("td",null,o.a.createElement("button",{className:"button",id:"#ffccff",onClick:M,style:{background:fe.get("#ffccff").background}})),o.a.createElement("td",null,o.a.createElement("button",{className:"button",id:"#80ffff",onClick:M,style:{background:fe.get("#80ffff").background}}))),o.a.createElement("tr",null,o.a.createElement("td",null,o.a.createElement("button",{className:"button",id:"#ff99c2",onClick:M,style:{background:fe.get("#ff99c2").background}})),o.a.createElement("td",null,o.a.createElement("button",{className:"button",id:"#99ff99",onClick:M,style:{background:fe.get("#99ff99").background}})),o.a.createElement("td",null,o.a.createElement("button",{className:"button",id:"#ff99ff",onClick:M,style:{background:fe.get("#ff99ff").background}}))))))))))})),b.visible&&function(e){var t=e.channel.id;return D.map((function(e){var n=e.item,a=e.key,r=e.props;return n&&o.a.createElement(k.a.div,{key:a,style:Object(O.a)({},r)},o.a.createElement(Re,{setVisible:E,top:b.style.top,left:b.style.left,channelId:t,style:Object(O.a)({},b.style)}))}))}(e),e.notes.map((function(e,t){return o.a.createElement(me,{key:e.id,id:e.id,left:e.left,top:e.top,open:!j,backgroundColor:e.backgroundColor,author:e.author,date:e.date,content:e.content,setOpen:N})})))),e.pictures.map((function(e){return o.a.createElement(Oe,Object.assign({id:e.id,key:e.id},e))})))):o.a.createElement("div",null,"odota")}))),ze=n(442),Le=n(229),Pe=(n(396),Object(f.b)((function(e){return{channel:e.channel}}),null)((function(e){var t=Object(c.useState)("channelNameAnim"),n=Object(s.a)(t,2),a=n[0],r=n[1];return Object(c.useEffect)((function(){r("channelNameAnim")}),[e.channel]),o.a.createElement("div",{className:a,onAnimationEnd:function(){return r("channelName")}},e.channel.name)}))),We=Object(f.b)((function(e){return{user:e.loggedUser}}),null)((function(e){var t=Object(c.useState)(""),n=Object(s.a)(t,2),a=n[0],r=n[1],i=Object(c.useRef)(0);Object(c.useEffect)((function(){return l(e.user),function(){clearTimeout(i.current),l(void 0)}}),[e.user]);var l=function e(t){var n=new Date;clearTimeout(i.current),t&&(r(n.toString().slice(16,24)),i.current=setTimeout(e.bind(null,t),1e3))};return o.a.createElement("div",null,a)}));n(397);function He(){var e=Object(d.a)(["\nborder: 1px solid #665533;\ncursor:pointer;\ncolor:#b29966;\nbackground-color:black;\ntransition: background-color 250ms ease-in, border-color 250ms ease-in, color 250ms ease-in;\n&:hover{\n  background-color:rgba(53, 46, 17, 0.6);\n  border-color: #b29966;\n  color: #d4c6aa;\n}\n"]);return He=function(){return e},e}var Me=N.a.button(He()),Ge=Object(f.b)((function(e){return{user:e.loggedUser,channel:e.channel,connectedUsers:e.connectedUsers,gapi:e.gapi}}),{clearUser:w})((function(e){var t=e.user,n=e.channel,a=e.connectedUsers,r=e.gapi,i=e.clearUser,l=Object(c.useState)(!0),u=Object(s.a)(l,2),d=u[0],f=u[1],m=Object(c.useState)(0),p=Object(s.a)(m,2),g=p[0],b=p[1],E=[{id:0,content:o.a.createElement("div",null)},{id:1,content:o.a.createElement(re,{setChat:f})},{id:2,content:o.a.createElement(le,{setChat:f})}];Object(c.useEffect)((function(){b(t?t&&d?1:2:0)}),[t,d]);var h=Object(k.b)(t,null,{from:{opacity:0,transform:"scale(0)"},enter:{opacity:1,transform:"scale(1)"},leave:{opacity:0,transform:"scale(0)"},config:{mass:1,tension:300,friction:12}}),v=Object(k.b)(E[g],(function(e){return e.id}),{from:{opacity:0},enter:{opacity:1},leave:{opacity:0},config:{duration:250}}),y=function(e){e.preventDefault(),document.getElementById("root").style.backgroundPositionX="0px",document.getElementById("root").style.backgroundPositionY="0px",document.getElementById("bg").style.backgroundPositionX="0px",document.getElementById("bg").style.backgroundPositionY="0px",i(t),f(!0),r&&r.auth2.getAuthInstance().signOut().then((function(){return console.log("Oauth2 Signout")}))};return o.a.createElement("div",null,o.a.createElement(_.a,{style:{margin:"0",padding:"0",backgroundColor:"transparent"},placeholder:!0},n&&o.a.createElement(ze.a,{backend:Le.a},o.a.createElement(Be,null))),o.a.createElement("div",{style:{position:"absolute",top:"2em",left:"40%"}},n&&o.a.createElement("span",{style:{width:"100%",fontWeight:"700",color:"#d4c6aa"}},o.a.createElement(Pe,null))),h.map((function(e){var t=e.item,n=e.key,a=e.props;return t&&o.a.createElement(k.a.div,{key:n,style:Object(O.a)({},a,{zIndex:"10",position:"absolute",top:"2em",left:"3em"})},o.a.createElement("div",{style:{fontFamily:"Cinzel, serif",fontSize:"1.4em",fontWeight:"700",textAlign:"left",color:"#b29966",textShadow:"-2px 0 black, 0 2px black, 2px 0 black, 0 -2px black"}},o.a.createElement(We,null)))})),v.map((function(e){var t=e.item,n=e.props,a=e.key;return o.a.createElement(k.a.div,{key:a,style:Object(O.a)({},n,{zIndex:"10",position:"absolute",top:"2em",right:"2em",minWidth:"22rem",width:"25vw",paddingRight:"0"})},t.content)})),h.map((function(e){var n=e.item,a=e.key,r=e.props;return n&&o.a.createElement(k.a.div,{key:a,style:Object(O.a)({},r,{zIndex:"10",position:"absolute",bottom:"2em",left:"2em"})},o.a.createElement("div",{style:{borderRadius:"2px 0px 0px 2px",fontSize:"1.2em",float:"left",display:"inline",fontWeight:"500",color:"#e5ddcc",whiteSpace:"nowrap",backgroundColor:"rgba(0,0,0,0.7)",marginTop:"1px",padding:"0.15em 0.5em 0.2em 0.35em",textShadow:"-1px 0 black, 0 1px black, 1px 0 black, 0 -1px black"}},t&&t.username," is logged in "),o.a.createElement("div",{style:{float:"left",display:"inline"}},o.a.createElement(Me,{style:{cursor:"pointer",fontSize:"1.1em",marginLeft:"0em",borderRadius:"2px",fontFamily:"Lato,Helvetica Neue,Arial,Helvetica,sans-serif",fontWeight:"700",padding:"0.25em 0.4em 0.25em 0.4em",textShadow:"-2px 0 black, 0 2px black, 2px 0 black, 0 -2px black"},onClick:y},"logout")))})),h.map((function(e){var t=e.item,n=e.key,r=e.props;return t&&o.a.createElement(k.a.div,{key:n,style:Object(O.a)({},r,{lineHeight:"1.1em",fontSize:"1.1em",textAlign:"center",position:"absolute",zIndex:"10",bottom:"2em",right:"2em",padding:"0.3em 0.6em 0.3em 0.6em",fontWeight:"500",border:"solid 1px #665533",color:"#b29966",whiteSpace:"nowrap",backgroundColor:"rgba(0,0,0,0.7)",textShadow:"-1px 0 black, 0 1px black, 1px 0 black, 0 -1px black"})},o.a.createElement("span",{style:{fontWeight:"400",color:"#e5ddcc",textAlign:"center",borderBottom:"1px solid #b29966"}},"connected users"),o.a.createElement("ul",{style:{fontWeight:"400",listStyleType:"none",marginTop:"0",marginBottom:"0",padding:"0.2em 0 0 0"}},a&&a.map((function(e,t){return o.a.createElement("li",{style:{flex:"right"},key:t},e)}))))})))})),Fe=(n(398),function(){var e=Object(c.useState)(!0),t=Object(s.a)(e,2),n=t[0],a=t[1];return Object(c.useEffect)((function(){a(!1)}),[]),n?o.a.createElement("div",{style:{width:"100vw",height:"100vh",background:"black"}},o.a.createElement("span",{style:{position:"absolute",top:"50%",left:"50%",fontSize:"2em",color:"#b29966",marginLeft:"-5rem"}},"loading...")):o.a.createElement(u.a,{id:"cont",style:{width:"100%",height:"100vh"}},o.a.createElement(z,null),o.a.createElement(Ge,null))}),Ke=n(226),Ye=n(43),Ve=n(227),Xe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CONNECTED_USERS":return t.data;default:return e}},qe=n(228),Je=n.n(qe),$e=Object(Ye.combineReducers)({messages:H,loggedUser:j,channels:V,gapi:y,pictures:ee,channel:ne,users:v,notes:J,error:ce,connectedUsers:Xe}),Qe=Object(Ye.createStore)((function(e,t){return"USER_LOGOUT"===t.type&&(e=void 0),$e(e,t)}),Object(Ke.composeWithDevTools)(Object(Ye.applyMiddleware)(Ve.a,(function(e){var t=Je()("ws://visualchat.onrender.com:"+Object({NODE_ENV:"production",PUBLIC_URL:"",REACT_APP_CLIENT_ID:"371216924606-rgdtfalqj9tklp61rkv27d9ii14cenbe.apps.googleusercontent.com"}).PORT);return t.on("message",(function(t){e.getState().channel.id===t.channelID&&e.dispatch({type:"SOCKET_MESSAGE_RECEIVED",data:{channel:t.channelID,messages:t.messages}})})),t.on("add_note",(function(t){e.getState().channel.id===t.channelID&&e.dispatch({type:"SOCKET_ADD_NOTE",data:t.note})})),t.on("callback",(function(t){var n;return r.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(e.getState().channel.id!==t.id){a.next=6;break}if(e.getState().loggedUser.token===t.token){a.next=6;break}return a.next=4,r.a.awrap($(e.getState().channel.id,e.getState().loggedUser));case 4:n=a.sent,e.dispatch({type:"INIT_PICTURES",data:n});case 6:case"end":return a.stop()}}))})),t.on("delete_note",(function(t){e.getState().channel.id===t.channelID&&e.dispatch({type:"SOCKET_DELETE_NOTE",data:t.noteID})})),t.on("set_note",(function(t){e.getState().channel.id===t.channelID&&e.dispatch({type:"SOCKET_SET_NOTE",data:t.note})})),t.on("myError",(function(t){e.dispatch({type:"SET_ERROR",data:t})})),t.on("channel",(function(t){t.users.find((function(t){return t===e.getState().loggedUser.userId}))&&e.dispatch({type:"SOCKET_ADD_CHANNEL",data:t})})),t.on("set_connected_users",(function(t){e.dispatch({type:"SET_CONNECTED_USERS",data:t})})),t.on("reconnect",(function(){e.getState().loggedUser&&t.emit("action",{type:"SET_USER",data:e.getState().loggedUser}),e.getState().channel&&t.emit("action",{type:"SET_CHANNEL",data:{user:e.getState().loggedUser.username,name:e.getState().channel.name,token:e.getState().loggedUser.token}})})),function(e){return function(n){return"SEND_WEBSOCKET_MESSAGE"===n.type||"CREATE_CHANNEL"===n.type||"ADD_NOTE"===n.type||"SET_NOTE"===n.type||"CALLBACK"===n.type||"DELETE_NOTE"===n.type||"SET_USER"===n.type||"USER_LOGOUT"===n.type||"SET_CHANNEL"===n.type?(t.emit("action",n),"SEND_WEBSOCKET_MESSAGE"===n.type||"SET_NOTE"===n.type||"SET_USER"===n.type||"USER_LOGOUT"===n.type||"SET_CHANNEL"===n.type?e(n):void 0):e(n)}}})))),Ze=function(){l.a.render(o.a.createElement(f.a,{store:Qe},o.a.createElement(Fe,null)),document.getElementById("root"))};Ze(),Qe.subscribe(Ze)}},[[243,1,2]]]);
//# sourceMappingURL=main.1070127d.chunk.js.map